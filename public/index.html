<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>ETC / 51</title>

    <link rel="stylesheet" href="./assets/styles/main.css">
</head>

<body>
<div class="wrapper">
    <header>
        <h1 id="home">Risk Evaluation of 51-Percent Attacks on Ethereum Classic</h1>

        <p>This document provides an analysis of the context and estimates of risk of Proof of Work finality fraud
            (51-percent attacks) on Ethereum Classic (ETC).</p>
    </header>
<!--    <div class="my-position-fixed">-->
        <div class="js-toc"></div>
<!--    </div>-->

    <main>
        <!-- --------------------------------------------------------------------------------------- -->
        <h2 id="section-summary">Summary</h2>

        <p>
            The following chart and table provide rough estimates for current expected attack costs and revenues.
            Estimates are derived from the configurable values below, along with a constant block time.
            <!--            Hashrate is not required in calculating the table's values.-->
            The <code>Net with MESS (USD)</code> column can be understood as a minimum payout
            from fraud that the attacker would need to break even given the cost of the attack.
        </p>


        <input type="number" name="block-time" id="block-time" disabled value="13.5">
        <label for="block-time">Block Time (Seconds)</label>
        <br>
        <input type="number" name="block-reward" id="block-reward" step=".01">
        <label for="block-reward">Block Reward (ETC)</label>
        <br>
        <input type="number" name="usd-etc" id="usd-etc">
        <label for="usd-etc">USD/ETC</label>
        <br>
        <input type="number" name="hashrate-efficiency-ratio" id="hashrate-efficiency-ratio" step=".01">
        <label for="hashrate-efficiency-ratio">Hashrate <a href="https://en.wikipedia.org/wiki/Efficiency_ratio">Efficiency
            Ratio</a></label>
        <!--        Hashrate Rental Cost is the cost of RENTING a GPU for the attacker to mine on.-->
        <!--        For example, if a car costs $10_000 new and $1_000 / year to keep, and lasts for 10 years,-->
        <!--        the overall cost of the car is $10_000 + $1_000 * 10 = $20_000, or $2_000 / year.-->
        <!--        This car might then be rented out (by the owner) for $2_000 * C / year, where C-->
        <!--        is analogous to the Hashrate Rental Cost defined above.-->
        <!--        https://en.wikipedia.org/wiki/Efficiency_ratio-->

        <canvas id="summary-chart" width="400" height="200"></canvas>

        <table id="summary-table">
            <tr class="header">
                <th>Duration (HH:MM)</th>
                <th>Number of Blocks</th>
                <th>Expense (w/o MESS) (USD)</th>
                <th>Revenue (USD)</th>
                <th>Net (USD)</th>
                <th>MESS Penalty</th>
                <th>Expense with MESS (USD)</th>
                <th>Net with MESS (USD)</th>
            </tr>
        </table>

        <h4 id="section-confirmation-delay-estimator-tool">Confirmation Delay Estimator Tool</h4>

        <div class="confirmation-estimator-tool">
            <p>
                <label for="confirmation-tool-usd">A transaction of value: USD</label>
                <input type="number" name="confirmation-tool-usd" id="confirmation-tool-usd" value="100000" step="100">
                <label for="confirmation-tool-etc">= ETC</label>
                <input type="number" name="confirmation-tool-etc" id="confirmation-tool-etc" value="">
                <br>
                should be given a confirmation delay of at least
                <strong style="" id="confirmation-tool-output-blocks"></strong> blocks,
                or <strong style="" id="confirmation-tool-output-time"></strong>.
            </p>
            <!-- FIXME/TODO -->
            <!-- I'VE DISABLED VISIBILITY OF THIS ROW FOR NOW. -->
            <!-- I THINK ITS STILL KIND OF UGLY AND HARD TO READ/USE.-->
            <!-- Maybe it would be nicer if the row were inserted, highlighted, in the actual table, or plotted in the chart... -->
            <!-- <table id="confirmation-tool-output-table" style="width: 100%;"></table>-->
            <table id="confirmation-tool-output-table" style="width: 100%; display: none;"></table>
        </div>

        <p class="modest">
            These estimates are rough. Factors not taken into account include, but are not
            limited to: block transaction fee revenues, difficulty adjustment rates,
            potentially variable hashrate availability (and/or/= cost),
            nor any “luck” margin for the miner’s target total difficulty.
        </p>

        <!-- --------------------------------------------------------------------------------------- -->
        <h2 id="section-history">History</h2>

        <p>
            In August 2020 a series of three 51-percent attacks were published on the Ethereum Classic network.
            These attacks were:
        <table>
            <tr class="header">
                <th>Date</th>
                <th>Start Block</th>
                <th>Blocks Reorged</th>
                <th>Timespan</th>
                <th>USD/ETC</th>
                <th>Th/s</th>
                <th>Attacker Address</th>
                <th>Fraud Value</th>
                <th>Victim</th>
                <th>References</th>
            </tr>

            <tr>
                <td>2020/08/01</td>
                <td>10_904_146</td>
                <td>3_594</td>
                <td>12h 12m</td>
                <td>$7.81</td>
                <td>4.9</td>
                <td style="max-width: 5rem; overflow: hidden; text-overflow: fade(30);">
                    0x75d1e5477f1fdaad6e0e3d433ab69b08c482f14e
                </td>
                <td>5.6M USD (807_000+ ETC)</td>
                <td>OKX</td>
                <td>
                    <ul>
                        <li>
                            <a href="https://medium.com/bitquery/ethereum-classic-51-chain-attack-july-31-2020-8fef107a81d8">BitQuery</a>
                        </li>
                        <li>
                            <a href="https://medium.com/ethereum-classic-labs/statement-regarding-ethereum-classic-chain-reorganization-a0d5c2de8fdf">
                                ETC Labs</a></li>
                        <li>
                            <a href="https://www.okx.com/academy/en/okex-responds-to-ethereum-classic-51-attacks-reveals-its-hot-wallet-system-incident-report">OKX
                                Incident Report</a></li>
                    </ul>
                </td>
            </tr>

            <tr>
                <td>2020/08/05</td>
                <td>10_935_622</td> <!-- 10940068 -->
                <td>4_446</td> <!-- 4236 per BitQuery, 15h06m-->
                <td>15h 37m</td>
                <td>$7.23</td>
                <td>1.3</td>
                <td style="max-width: 5rem; overflow: hidden; text-overflow: fade(30);">
                    0x3936968A445B723fdd0C0407efFfcaECb07cab19
                </td>
                <td>3.3M USD (465_444 ETC)</td> <!-- same as above -->
                <td>Bitfinex</td> <!-- <strike>OKX</strike>  -->
                <td>
                    <ul>
                        <li><a href="https://bitquery.io/blog/ethereum-classic-attack-8-august-catch-me-if-you-can">BitQuery</a>
                        </li>
                        <li><a href="https://twitter.com/binance/status/1291225022866944000">Binance Tweet</a></li>
                    </ul>

                </td>
            </tr>
            <!--        <a href="https://2miners.com/blog/ethereum-classic-under-another-51-attack-what-do-we-know-about-the-attackers-actions/"></a>-->
            <!--        <a href="https://blog.coinbase.com/coinbases-perspective-on-the-recent-ethereum-classic-etc-double-spend-incidents-1fd19ef215f3"></a>-->

            <tr>
                <td>2020/08/29</td>
                <td>11_090_590</td>
                <td>7_278</td>
                <td>26h 20m</td>
                <td>$6.53</td>
                <!-- 11097868=actual highest block, 11097869..11098871=latest 'spotty' mining chapter (1002 blocks) -->
                <td>3.2</td>
                <td style="max-width: 5rem; overflow: hidden; text-overflow: fade(30);">
                    0x17d1B181C72Be2d3a3212e7725F31F13F7929Ce2
                </td>
                <td>?</td>
                <td>?</td>
                <td>
                    <ul>
                        <li>
                            <a href="https://www.coindesk</li>.com/markets/2020/08/29/ethereum-classic-hit-by-third-51-attack-in-a-month/">Coindesk</a>
                        <li><a href="https://twitter.com/etherchain_org/status/1299822510607917056">Bitfly Tweet</a>
                        </li>
                    </ul>

                </td>
            </tr>
        </table>

        <p class="modest">
            In the first of these reorganizations, a bug in the Parity client caused a small network split.
            The client was unable to handle the large reorganization correctly because of insufficient data pruning
            rules. The Parity client represented a small minority of nodes at the time.
        </p>
        <p class="modest">
            In apparently all three attacks, Nicehash.com was used to provide the hashrate necessary to mine the attack.
            Nicehash has since issued a<a
                href="https://www.nicehash.com/blog/post/official-response-regarding-the-latest-51-attack-allegations">
            statement</a> noting that they do not endorse such behavior.
        </p>
        </p>

        <!-- --------------------------------------------------------------------------------------- -->
        <h2 id="section-analysis-chain-state-finality">Analysis: Chain State Finality</h2>

        <h3 id="section-what-a-51-percent-attack-is">What a 51-percent attack is</h3>

        <p>
            A “51% attack” is a scheme in which an “attacker” commits fraud against some victim, with the attacker
            renegging on their side of some transaction after receiving a counterparty’s corresponding payment.</p>
        <p>
            They do this by secretly mining a chain which critically omits the depositing transaction to the
            counterparty. Once the attacker receives the victim’s side of the exchange (which was predicated on the
            attacker’s deposit), the attacker publishes their chain, invalidating their end of the bargain.</p>
        <p>
            History is rewritten, and the attacker has received something for nothing, less the cost of carrying out the
            scheme.</p>

        <h3 id="section-hashing-availability">Hashing Availability (and Cost)</h3>

        <p>
            In order for an attacker to mount an attack, they must have the capital necessary to do so.
        </p>

        <p>
            While a theoretical cost can be derived for arbitrary hash rates,
            actual material resource availability is both extremely difficult to estimate,
            and a very important limitation for the attack strategy.
        </p>
        <p>
            Hashrate cost is a function of (at least) the hardware itself and the cost of running the hardware, ie.
            electricity.
        </p>
        <p class="modest">
            See <a href="https://blog.coinbase.com/how-coinbase-views-proof-of-work-security-f4ba1a139da0">
            Coinbase's <i>How Coinbase views proof of work security</i></a> for an introduction to general Proof of Work
            security considerations with regard to hardware.
        </p>

        <h4 id="section-etc-daggerhashimoto-etchash">Mining Algorithm</h4>
        <p>
            The original mining algorithm <i>Dagger-Hashimoto</i> (aka <code>ethash</code>), still in use today by
            Ethereum,
            has been changed to <code>etchash</code> on Ethereum Classic.
        </p>
        <p>
            At block 11_700_000 (2020 November 28), Ethereum Classic implemented <a
                href="https://github.com/ethereumclassic/ECIPs/blob/master/_specs/ecip-1099.md/">ECIP-1099</a>,
            extending the Hashimoto DAG epoch length by a factor of 2, and thus lowering the requirement for mining
            hardware memory allocation, which had recently exceeded 4GB.
        </p>
        <p>
            This change was and is expected to recover and increase hardware availability for the mining algorithm.
            Greater hardware availability should lead to greater network hashrate.
            <!--            Although not necessarily linearly across the competing hashrate markets.-->
        </p>
        <p>
            It also had the side-effect of removing the Ethereum Classic mining protocol from defaults provided by
            on-demand hashrate marketplaces, notably <a href="https://www.nicehash.com/">Nicehash.com</a>.
        </p>
        <p>
            The hardware available for mining on ETC is now a <em>superset</em> of the hardware capable of mining ETH.
            This means that the current hashrate on ETH should be considered as a representative minimum of potentially
            applicable hardware to ETC.
        </p>
        <p>
            The <code>etchash</code> algorithm is supported by various mining software; including but not limited to
            <code>PhoenixMiner</code>, <code>T-Rex</code>, <code>Gminer</code>, and <code>lolMiner</code>.<sup><a
                href="https://2miners.com/blog/how-to-mine-ethereum-classic-etc-mining-and-profitability">2miners</a></sup>
        </p>
        <p>
            <a href="https://whattomine.com/coins/162-etc-etchash">WhatToMine</a> provides a hardware cost/benefit
            analysis tool
            for ETC and <code>etchash</code>.
        </p>

        <h3 id="section-potential-hashrate-availability-estimates">Potential Hashrate Availability Estimates</h3>

        <p>
            While Ethereum obviously represents the largest application of ETC-compatible hash power<sup>
            <a href="https://en.bitcoinwiki.org/wiki/Dagger-Hashimoto">Dagger-Hashimoto</a>/<a href="https://en.bitcoinwiki.org/wiki/Ethash#Coins">Ethash</a>
        </sup>,
            there are other applications which together compose a global supply.
            For example, <a href="https://2miners.com/exp-network-hashrate">Expanse (EXP)</a> and
            <a href="https://ubiqsmart.com/">Ubiq (UBQ)</a> both use the memory-hard <strike>Dagger-Hashimoto</strike>
            Ethash mining algorithm,
            but represent 24.83 Gh/s <sup><a href="https://2miners.com/exp-network-hashrate">2miners</a></sup>
            and 4.28 Gh/s <sup><a href="https://minerstat.com/coin/UBQ/network-hashrate">minerstat</a></sup>
            respectively, or around 1/1200 and 1/7000 that of ETC.
        </p>

        <p>
            Considering only the hashrate on Ethereum,
            we can identify entities in possession of sufficient hashrate to attack Ethereum Classic.
        </p>

        <p>
            The current hashrate on Ethereum is <code id="eth-hashrate-current"></code>.
            The current hashrate on Ethereum Classic is <code id="etc-hashrate-current"></code>.
            So the current applicable global hashrate is their sum: <code id="global-hashrate"></code>.
            So Ethereum Classic represents <span id="etc-global-hashrate-share"></span>
            of global, observable, ETH/ETC-compatible hashrate.
        </p>
        <p>
            Given the <a href="https://etherscan.io/stat/miner?range=7&blocktype=blocks">top miner shares on
            Ethereum</a>,
            we annotate those miners on Ethereum whose hashrate is sufficient to attack Ethereum Classic.
        </p>

        <table id="eth-miners" style="width: 100%;">
            <tr class="header">
                <th>Address</th>
                <th>Name</th>
                <th>Share ETH (%)</th>
                <th>~ Hashrate (xETC)</th>
            </tr>
        </table>

        <h3 id="section-mess">MESS: A Finality Mechanism</h3>

        <p>
            MESS stands for “Modified Exponential Subjective Scoring.” MESS is a protocol strategy <a
                href="https://blog.ethereum.org/2014/11/25/proof-stake-learned-love-weak-subjectivity/">originally
            proposed by
            Vitalik Buterin</a> and modified (slightly) by me, Isaac Ardis. Its specification can be found at <a
                href="https://github.com/ethereumclassic/ECIPs/blob/master/_specs/ecip-1100.md">ECIP-1100</a>.
        </p>
        <p>
            MESS was developed and implemented in reaction to a series of three 51-percent attacks occurring on ETC in
            August 2020 worth around 5 million USD.
            At this time, the hashrate on ETC was around 5 Th/s, and the exchange rate was around $7 USD/ETC.
            The attacker's hashrate was apparently acquired via Nicehash.com.
        </p>
        <p>
            MESS increases the cost of producing a competitive chain by opinionating the network clients toward their
            incumbent chain (weak subjectivity), at a rate (pseudo-exponentially) proportional to the length of the
            competitive chain segment.
            Because of an increased cost of producing a competitive chain, finality expectations for the honest public
            network
            rise.
        </p>

        <blockquote>This all seems reasonable! <sup><a
                href="https://github.com/ethereumclassic/ECIPs/issues/374#issuecomment-694156719">@vbuterin</a></sup>
        </blockquote>

        <h4 id="section-mess-effects">MESS Protocol</h4>

        <p>
            The "penalty" curve implemented by MESS is a function of the length (as timestamp difference) of the
            incumbent competitive chain segment. This curve is graphed below:
        </p>

        <canvas id="mess-penalty-chart" width="400" height="200"></canvas>

<!--        <div class="" style="text-align: center;">-->
<!--            <img src="https://user-images.githubusercontent.com/45600330/181563591-38d25db3-8e6f-40fc-8e0d-2b3f9d0919ea.png"-->
<!--                 alt="ecbp1100-polynomial" style="max-width: 400px; display: inline-block;"/>-->
<!--        </div>-->

        <p>
            This curve expresses a unitless multiple imposed as a comparative demand on the competing chain segment
            Total Difficulty (TD). It is defined as a polynomial with a minimum value of 1
            (<code>f(0)=1</code>), and a maximum value of 31 (<code>f(25132)=31</code>).

        <blockquote>
            Having a cap at 32x or some value in that ballpark seems totally reasonable; you're right that there's no
            need to have the ratio keep increasing forever.
            <sup><a href="https://github.com/ethereumclassic/ECIPs/issues/374#issuecomment-694156719">
                @vbuterin
            </a></sup>
        </blockquote>

        The polynomial is defined as follows, with <code>x</code> being the timestamp difference between a
        local head and the common ancestor (fork block).
        <pre><code class="prism language-js">const ecbp1100PolynomialVCurveFunctionDenominator = 128;
const ecbp1100PolynomialVXCap = 25132;
const ecbp1100PolynomialVHeight = ecbp1100PolynomialVCurveFunctionDenominator * 15 * 2;

/**
 * @param {number} x - Timestamp difference between local head and common ancestor (fork block)
 * @return {number} - The polynomial value at x
 */
function ECBP1100_Penalty(x) {
    if (x > ecbp1100PolynomialVXCap) x = ecbp1100PolynomialVXCap;
    let xa = 3 * (x ** 2);
    let xb = (2 * (x ** 3)) / ecbp1100PolynomialVXCap;
    let y = xa - xb;
    y = y * ecbp1100PolynomialVHeight;
    y = y / ecbp1100PolynomialVXCap ** 2;
    y = y + ecbp1100PolynomialVCurveFunctionDenominator;
    y = y / ecbp1100PolynomialVCurveFunctionDenominator;
    return y;
};</code></pre>
        <br>
        This function is then implemented in client canon-arbitration rules as:
        <pre><code class="prism language-js">/**
 * @param {Block} original - The original (and current) canonical block
 * @param {Block} proposed - The proposed block, displacing the original's canon status
 * @param {Block} commonAncestor - The block these forks (original v. proposed) diverged at
 * @return {bool} - Whether the proposed block should become canonical instead of the original block
 */
function isProposedCanonical(original, proposed, commonAncestor) {
        // Derive the MESS penalty.
        const messPenalty = ECBP1100_Penalty(original.timestamp - commonAncestor.timestamp);

        // Apply the penalty condition.
        if (messPenalty /* [1.0-31] */ * original.TD >= proposed.TD) {
            return false;
        }

        // Reaching here, the proposed segment should become canonical;
        // it has exceeded the TD demand imposed under MESS.
        return true;
}</code></pre>
        </p>

        <h4 id="section-mess-rationale">MESS Rationale</h4>

        <h5 id="section-mess-alternative-strategies">Alternative Strategies</h5>

        <p>
            Given the difficult and urgent problem of increasing finality expectations without increasing hash rate or
            exchange rate,
            and without compromising the network's <i>raison d'etre</i>, several strategies <a
                href="https://ethereumclassic.org/blog/2020-09-25-core-devs-call-51-attack-solutions">were
            considered</a>.

            Among these strategies were:
        <ul>
            <li>
                Several <strong><a
                    href="https://github.com/ethereumclassic/ECIPs/blob/7c596137e88038fccc293f42a2a3d01c54c27c35/_specs/ecip-1097.md">checkpointing
                protocols</a></strong>, which depended on the assertion of an authority entity,
                compromising the core principles of decentralized and permissionless consensus,
                and necessitating the intractable problem of to Whom to the authoritative trust would be assigned.
            </li>
            <li>
                A <strong><a href="https://veriblock.org/">proof-of-proof protocol</a></strong> which delegated
                trust(lessness) to a third-party authority entity (ie. Bitcoin). This has the same fundamental problem
                as checkpointing: authority assignment.
            </li>
            <li>
                A <strong>peer-to-peer <a
                    href="https://github.com/ethereumclassic/ECIPs/blob/7d259a0f07c62604ab0bb75b1baeb1d00b32a687/_specs/ecip-1106.md">endorsement
                scheme</a></strong> intended to materialize practical heuristics about chain segment preference (ie.
                following established and human-trusted miners), but again, these compromised the rationale of the
                network's foundational principles.
            </li>
            <li>
                <strong><a href="https://github.com/ethereumclassic/ECIPs/issues/327">PirlGuard</a></strong>, a
                subjective scoring strategy, which was evaluated to present unacceptable critical attack vectors.
            </li>
            <li>
                A <strong><a
                    href="https://github.com/ethereumclassic/ECIPs/blob/381fc5e9f3ae48a0c953227440136308cad221f0/_specs/ecip-1017.md">monetary
                policy</a></strong> adjustment that would increase the rate of inflation in the short term,
                and decrease it in the long(er) term, while keeping the overall anticipated supply constant.
                This would have been expected to increase the incentive to mine during the period of paucity,
                but would have compromised the promises implicit in the design and purpose of the policy.
            </li>
            <li>
                Do <strong>nothing</strong>. A valid argument can claim that the issue is one of criminal behavior and
                risk management practices of the defrauded consumer, not the network protocol.
                An adequate confirmation delay relative to transaction value mitigates the risk effectively.
                This option was impossible due to constraints and pressure from the community.
                Network finality is associated with network utility.
            </li>
        </ul>
        Ultimately, <strong>MESS</strong> was selected for its simplicity, robustness, and closeness to core principles.
        </p>

        <h4 id="section-mess-discussion">MESS Discussion</h4>
        <h5 id="section-mess-discussion-concern-timestamps-plus-sybil">Concern: Timestamp Manipulation + Network-wide Sybil Attack</h5>
        One participant in the discussion of MESS raised a concern as follows:
        <p>
        <blockquote>
            Your new solution improves the protection but still allows a different selfish mining attack. It requires
            more hashrate and very high network connectivity.
            <br><br>
            This is the attack:
            <br><br>
            We assume the attacker has two times (plus epsilon) the honest hashrate. Let's assume that the victim is
            waiting for C confirmations. So the attacker first starts mining a public chain A with 1-second intervals
            and with a hashrate that exceeds the honest hashrate. But he keeps mining his blocks in private. If the
            honest miners create a block on top of A, then the attacker releases immediately one of his private blocks
            so that nodes see the attacker block before the honest block, and therefore all the blocks in fork A will be
            generated by the attacker, and always the timestamp of the best block in A will be in the past.
            This is a 51% attack combined by a selfish-mining attack.
            <br><br>
            At the same time the attacker is mining a fork B with more hashrate than A. This fork has normal timestamps
            (or past timestamps, it doesn't matter). When the fork A is C blocks in length (and the victim has already
            confirmed the double-spent transaction) he leaves fork A and reveals fork B. Nodes will apply a very low
            penalty on B because the best block in A has a timestamp that is 10 times closer to the common ancestor than
            what is expected.
            <br><br>
            While this attack requires much more resources (2X the hashrate and higher control over the network), it's
            still possible.
            <br><br>
            My proposal of the availability rule would not accept fork A as valid in the first place, and therefore the
            double-spend transaction will never be confirmed in fork A.
            <sup><a href="https://github.com/ethereumclassic/ECIPs/issues/374#issuecomment-699152317">@SergioDemianLerner</a></sup>
        </blockquote>
        </p>

        <p>
            A close look at the reasoning here discovers a few critical issues with the argument.
        <ul>
            <li>If <span class="q">the attacker has two times the public hashrate (plus epsilon)</span> (<code>(2*publicHashrate+e)/2</code>),
                and must mine the public chain as well as a competitive chain simultaneously,
                it stands to reason that their assumed hashrate will be insufficient.
                If the attacker spends half of their available hashrate (<code>1*publicHashrate+e</code>) mining the
                public chain,
                the resulting hashrate on the public chain will be <code>2*publicHashrate</code>,
                while the attacker will have only <code>1*public hashrate</code> to spend building the private competing
                segment.
            </li>
            <li><span class="q">If the honest miners create a block on top of A, then the attacker releases immediately one of his
                private blocks so that nodes see the attacker block before the honest block, and therefore all the
                blocks in fork A will be generated by the attacker.</span>
                Here, the attacker (or the author) underestimates the cost of producing blocks sufficient to suppress
                those of the rest of the network.
                If the attacker has <code>1*publicHashrate</code> applied to this purpose in competition with the honest
                miners,
                together themselves representing <code>1*publicHashrate</code>,
                the attacker's hashrate will only be able to produce a winning block 50% of the time relative to the
                honest public.
                With that understanding, obviously the expectation for the attacker's success approaches zero,
                since perfect success can be quantified as a sequential <code>n</code> trials with
                <code>P(n)=0.5**n</code>
                If the attacker is unable to provide a replacement block only <i>once</i>, the honest miners will
                insert a canonical block with a current timestamp, unraveling the strategy entirely.
            </li>
            <li>Generally, the feature where <span class="q">[the attacker] releases [...] one of his private blocks so that nodes see the attacker block before the honest block</span>
                would be practically extraordinarily difficult to achieve.
                It would require a comprehensive view and control of the global, decentralized, permissionless network.
                An attack of this variety and magnitude would effectively become a network-wide <a
                        href="https://en.wikipedia.org/wiki/Sybil_attack">Sybil attack</a>,
                a circumstance no blockchain, real or theoretical, would be equipped to handle.
            </li>
        </ul>
        </p>

        <h4 id="section-mess-vulnerabilities">MESS Known Vulnerabilities</h4>
        <p>Because the MESS protocol induces nodes to act decisively on an evaluation of a subjective data point (local
            head), network consensus is vulnerable to bifurcation under circumstances which are expected to be
            difficult to achieve (from an attacker’s persepctive: <em>costly</em>).</p>
        <p>An effort has been made to quantify the expected cost of such a vulnerability. This effort from December 2020
            estimated the cost at around “20_000 USD upfront, and 5_000 USD per month to maintain the split.” <sup><a
                    href="./MESS%20Exploit%20Details%20and%20Simulation.pdf">Veriblock v1</a></sup> At this time, ETC
            had a network hashrate around 5Th/s.</p>
        <p>It is my opinion on this work that the model it bases its findings on is naive and occassionally incorrect,
            and that its claims are underestimates (since, at least, complexity is probably expensive).</p>
        <p>Of further note is that this vulnerability is <em>a different category</em> of vulnerability than a
            51-percent attack. Where the 51-percent scheme is a scenario pitting a fraudster against one or a few
            victims, the vulnerability resulting from the mechanics of the MESS protocol is nearer in spirit to
            terrorism (or a controlled market short) since bifurcating the network would likely destroy its value.</p>

        <!-- --------------------------------------------------------------------------------------- -->
        <!--
    For a GOOD risk analysis of fraud on ETC, there are some more important things to consider:
    - ETC transaction throughput value, the number and scale (value) of transactions per second. (ie. Volume).
    - Exchange (client) confirmation rates.
    Since the risk of fraud is borne and controlled by the client (eg. an exchange),
    the analysis needs to try to understand the outlooks of client behavior.
    We can use transaction throughput (ie. Volume) to measure how much currency is being traded,
    and thus how much is at stake (over time; as a frequency).
    The volume measurement then needs to be shared (as shares; ratios) over the clients by confirmation delay rates.
-->
        <h2 id="section-analysis-consumer-risk-profiles-tx-volume">Analysis: Consumer Risk Profiles and Transaction Volume</h2>

        <p>
            Although chain state finality expectations are important in understanding finality fraud risk,
            consumer behavior and overall trading volume are equally important to understanding an overall risk profile;
            the risks from fraud are largely borne and managed by the consumer.
        </p>

        <p>
            <strong>Consumer behavior</strong> is important because risk profiles considered in aggregate
            define the risk exposure for the market in general. In the context of this document,
            we 'll limit our consideration of consumers to high-profile cryptocurrency exchanges,
            expecting that they represent a sufficient heuristic for the market at large.
        </p>

        <p>
            <strong>Transaction (trading) volume</strong> is important because it represents the value at stake for some
            measure of risk.
            It should be noted that in this context, "transaction volume" is not necessarily spot exchange volume,
            but the volume of transactional value moved through the network.
            Conventional trading volume, on the other hand, can be managed in proprietary escrow by exchanges at a layer
            above the network's.
        </p>
        <p>
            Chain state analysis shows that for the last 7 days from the time of writing,
            the ETC network had mean and median transaction values of 35 ETC and 43 ETC per transaction respectively,
            and a mean 8 transactions per block.
        </p>

        <table style="width: 100%;">
            <tr>
                <th>Exchange</th>
                <th>Share Market Volume</th>
                <th>Confirmation Delay (Blocks)</th>
                <th>Source</th>
            </tr>
            <tr>
                <td>Upbit.com</td>
                <td>21.37%</td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>Binance.com</td>
                <td>~17+%</td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>OKX.com</td>
                <td>4.39+%</td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>AAX.com</td>
                <td>2.88%</td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>Gate.io</td>
                <td>1.58%</td> <!-- estimated market share (share of volume traded) -->
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>Huobi.com</td>
                <td>1.31%</td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>Coinbase.com</td>
                <td>1.1%</td>
                <td>3000?,10000?</td>
                <td>
                    <a href="https://help.coinbase.com/en/coinbase/getting-started/crypto-education/ethereum-classic-etc-faq">help.coinbase.com</a>
                </td>
            </tr>
            <tr>
                <td>Kraken.com</td>
                <td>0.9%</td> <!-- estimated market share (share of volume traded) -->
                <td>40000</td>
                <td>
                    <a href="https://support.kraken.com/hc/en-us/articles/203325283-Cryptocurrency-deposit-processing-times">support.kraken.com</a>
                </td>
            </tr>
            <tr>
                <td>coinone.co.kr</td>
                <td>0.89%</td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>kucoin.com</td>
                <td>0.7%</td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>Bitfinex.com</td>
                <td>0.11%</td>
                <td></td>
                <td></td>
            </tr>
        </table>

        <p class="modest">
            <a href="https://coinmarketcap.com/currencies/ethereum-classic/markets/">Table data source</a>.
            Do you trade on one of these platforms? If so, please
            <a href="https://github.com/meowsbits/51-percent-docs/edit/master/public/index.html">help</a>
            fill in this table's confirmation delay fields.
        </p>

        <h2 id="section-outlook">Outlook</h2>

        <p>
            The fundamental solution to Ethereum Classic's finality fraud and attack risk exposure is
            an increase in hash rate relative to the global availability of applicable hash power.
            Hash rate is highly correlated with exchange rate, which, ostensibly, is associated with the utility and
            desirability of the network.
        </p>
        <p>
            We assume the Ethereum network is currently the dominant application of ETC-compatible hash power,
            representing hash and exchange rates around 20-50x that of Ethereum Classic.
        </p>
        <p>
            Ethereum plans to move to Proof of Stake in the near future, which will forcibly eject its mining interests.
            As the second largest cryptocurrency application of this hash power, it stands to reason that ETC should
            expect its hash rate to be augmented by at least some of those abandoned miners.
            This opinion is echoed by JP Morgan in a <a href="https://www.coindesk.com/tech/2022/08/11/jpmorgan-ethereum-miners-face-an-abrupt-change-following-the-merge/">Coindesk article</a> from 11 Aug 2022:

            <blockquote>
        Ethereum Classic (ETC) miners could be among the main beneficiaries of the switch, JPMorgan said.
        That’s because there’s likely to be a surge of secondhand mining rigs available from ETH miners
        that have decided to become validators on Ethereum 2.0.
        <br><br>
        There are signs this shift to Ethereum Classic is already taking place, with a noticeable increase in the hashrate since mid-July, the bank said.
        Some investors also view Ethereum Classic as a “hedge against any potential disruptions in the Ethereum blockchain during the shift from PoW to PoS,” according to JPMorgan.
    </blockquote>
        </p>
        <p>
            If Ethereum Classic achieves the position as the dominant application of the hash power,
            its risk exposures would drop to a minimum, MESS would become useless, and exchange rate should correspond
            to these improvements.
        </p>

        <hr>
        <!-- --------------------------------------------------------------------------------------- -->
        <h2 id="section-appendix">Appendix</h2>

        <h3 id="derivation-of-cost-values">Derivation of Cost Values</h3>
        <p>
            Since marketplace prices for ETC-compatible hashing power have become murky with the omission of <code>etchash</code>
            from
            popular on-demand hashrate marketplaces, we must assume the task of building a usable estimate for
            ETC-compatible hashrate cost.
            To do so, we build from a general economic intuition that the cost of hashrate should be
            slightly (or somewhat) less than the revenue it earns.
            If the costs exceeded the revenue, miners would not be incentived to commit work to the chain. If the
            revenue dramatically exceeded the costs, hashrate would rise with increased competition for the spoils of
            the market inefficiency.</p>
        <p>
            Given these constraints, we provide a sort of reverse-engineered estimation of ETC’s hashing cost using
            publicly available information for ETC’s younger sister, ETH.</p>
        <p>
            We first show that a cost estimate is close to an expected potential revenue.</p>
        <p>
            If ETH’s hashrate is 929.397 TH/s and the cost of marketplace DaggerHashimoto hashrate is 0.99 BTC/TH/24h
            and
            the ETH:BTC exchange rate is 0.07127 then the cost of marketplace DaggerHashimoto hashrate in ETH is <code>0.99
            * (1/0.07127=14) = 13.9</code> ETH/TH/24h</p>
        <p>
            At these rates, the cost of an equilibrium chain would be at least matching its current hashrate at the
            current hashrate price 929.397 * 13.9 ETH/24h = 12910.1 ETH / 24h</p>
        <p>
            ETH’s block time is 13.5 seconds yielding (24<em>60</em>60 seconds / 24hr = 86400 seconds / 13.5 seconds =
            6400 blocks / day) ETH’s block reward is 2 ETH / block. <sup><a
                href="https://github.com/ethereum/go-ethereum/blob/d8f963811df6ef97c76c9b4f433bf0bc936051e2/consensus/ethash/consensus.go#L44">Source</a></sup>
        </p>
        <p>
            The ETH token currency inflates at at least 6400 blocks * 2 ETH per day = 12800 ETH per day. A competitive
            chain could be built at a cost of 12910.1 ETH / day if hashrate were purchased in the on-demand marketplace
            considered.</p>
        <p>
            This analysis seems to fit our bespoke intuitive expectations for price vs. revenue models in a competitive
            and efficient market.</p>
        <p>
            We now apply this validated intuition as a heuristic for ETC’s hashing cost.</p>
        <p>
            ETC’s block time is roughly the same as ETH’s (though slightly faster because of relatively greater
            Difficulty volatility), so ETC also produces 6400 blocks / day.</p>
        <p>
            ETC’s block reward is 2.56 ETC, so ETC inflates at least <code>2.56 * 6400 = 16384</code> ETC / day.</p>
        <p>
            If we assume that the revenue should roughly match the production cost in ETC as it seems to in ETH then we
            could expect a mining cost of 16384 ETC * 36 USD/ETC = 589_824 USD / day, or 24_576 USD / hr.</p>

        <!--        <h3>Further Reading</h3>-->

        <!--        &lt;!&ndash;        - [gist:meowsbits Make ETC Mutable Again?](https://gist.github.com/meowsbits/adcb6a4e12431809bf3b138a2ada6d5e)&ndash;&gt;-->
        <!--        &lt;!&ndash;        - [gist:meowsbits How to Mutate Ethereum Classic Account States](https://gist.github.com/meowsbits/8fa2ec4b8cca828ce6aec3863fedd6d6)&ndash;&gt;-->
        <!--        &lt;!&ndash;        - [gist:meowsbits Reorg Caps and Confirmation Limits: A Primer on Soft Finality Arbitration](https://gist.github.com/96bb1856b0051f78a59a1f7e79d03854)&ndash;&gt;-->

        <!--        &lt;!&ndash;        <a href="https://www.nicehash.com/blog/post/official-statement-regarding-the-latest-51-percent-attack-allegations-aug-2020#!"></a>&ndash;&gt;-->


    </main>
    <hr>
    <footer>
        <strong>This website's source:</strong>&nbsp;<a href="https://github.com/meowsbits/51-percent-docs">https://github.com/meowsbits/51-percent-docs</a>
    </footer>
</div>
<script src="./assets/scripts/bundle.js"></script>
</body>

</html>
